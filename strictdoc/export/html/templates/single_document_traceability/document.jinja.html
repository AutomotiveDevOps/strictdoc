<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="static/global.css" />
  <link rel="stylesheet" href="static/layout-main-with-toc.css" />
  <link rel="stylesheet" href="static/single_document_traceability.css" />
  <title>{{document.name}} - Traceability</title>
</head>

<body>
  {%- set document_iterator = traceability_index.get_document_iterator(document) -%}
  <div class="layout-with-toc open">

    <aside class="toc">
      {% include "_shared/table_of_contents.jinja.html" %}
    </aside>

    <main class="content">
      <h1>{{document.name}} <span class="document-view-type">Traceability</span></h1>


  {%- if traceability_index.has_tags(document) -%}
    <div id="tags-outline">
    {%- for tag in traceability_index.get_tags(document) %}
      <span class="tag">
        {{ tag[0] }} x {{ tag[1] }}
      </span>
    {%- endfor %}
    </div>
  {%- endif %}

  <div id="sections-and-requirements">
  {%- for section_or_requirement in document_iterator.all_content() %}
    <div class="table-row">
    {%- if section_or_requirement.is_requirement %}
      <div class="cell cell-parent">
        {%- for requirement in traceability_index.get_parent_requirements(section_or_requirement) %}
          <div class="requirement">
            {% include "single_document_traceability/requirement.jinja.html" %}
          </div>
        {%- endfor %}
      </div>

      {%- set requirement = section_or_requirement %}
      <div class="cell cell-central" id="{{ requirement.uid }}">
        <div class="requirement">
          {% include "single_document_traceability/requirement.jinja.html" %}
        </div>
      </div>

      <div class="cell cell-children">
        {%- for requirement in traceability_index.get_children_requirements(section_or_requirement) %}
          <div class="requirement">
            {% include "single_document_traceability/requirement.jinja.html" %}
          </div>
        {%- endfor %}
      </div>
    {%- elif section_or_requirement.is_section %}
      <div class="cell cell-parent">
      </div>
      <div class="cell-section">
        {%- set section = section_or_requirement %}
        <h{{ section.ng_level }}>
          <span class="level">
            {{ section.export_title }}
          </span>
          {{ section.title }}
        </h{{ section.ng_level }}>
      </div>
      <div class="cell cell-children">
      </div>
    {%- elif section_or_requirement.is_free_text %}
      <div class="cell cell-parent">
      </div>
      <div class="cell cell-central">
        {{ section_or_requirement.text }}
      </div>
      <div class="cell cell-children">
      </div>
    {%- endif %}
    </div>
  {%- endfor %}
  </div>

</main>
</div>
</body>
