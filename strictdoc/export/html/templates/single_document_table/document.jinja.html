<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="static/global.css" />
  <link rel="stylesheet" href="static/single_document_table.css" />
  <title>{{document.name}} - Table</title>
</head>

<body>
  <h1>{{document.name}} - Table</h1>

  <a href="index.html">Back to Index</a>

  <br/>

  {%- set document_iterator = traceability_index.get_document_iterator(document) -%}
  {% include "_shared/table_of_contents.jinja.html" %}

  {%- if traceability_index.has_tags(document) -%}
    <div id="tags-outline">
    {%- for tag in traceability_index.get_tags(document) %}
      <span class="tag">
        {{ tag[0] }} x {{ tag[1] }}
      </span>
    {%- endfor %}
    </div>
  {%- endif %}

  <table id="sections-and-requirements">
  {%- for section_or_requirement in document_iterator.all_content() %}
      {%- if section_or_requirement.is_free_text %}
        <tr class="table-row">
          <td colspan="4" class="cell">
            {%- for text_paragraph in section_or_requirement.text_as_paragraphs() -%}
              <p class="text-paragraph">{{ text_paragraph }}</p>
            {%- endfor -%}
          </td>
        </tr>
      {%- elif section_or_requirement.is_composite_requirement %}
        <tr class="table-row table-row-header">
          <td colspan="4" class="cell">
            {%- set section = section_or_requirement %}

            <h{{ section.ng_level }}>
              <span class="level">
                {{ section.export_title }}
              </span>
              {{ section.title }}
            </h{{ section.ng_level }}>

          </td>
        </tr>
        {%- if not loop.last -%}
          {%- if not loop.nextitem.is_section and not loop.nextitem.is_free_text -%}
            {% include "single_document_table/table-fields.jinja.html" %}
          {%- endif -%}
        {%- endif -%}
        <tr class="table-row">
          {%- set requirement = section_or_requirement %}
          {% include "single_document_table/requirement.jinja.html" %}
        </tr>
      {%- elif section_or_requirement.is_requirement %}
        <tr class="table-row">
          {%- set requirement = section_or_requirement %}
          {% include "single_document_table/requirement.jinja.html" %}
        </tr>
      {%- elif section_or_requirement.is_section %}
        <tr class="table-row table-row-header">
          <td colspan="4" class="cell">
            {%- set section = section_or_requirement %}
            <h{{ section.ng_level }}>
              <span class="level">
                {{ section.export_title }}
              </span>
              {{ section.title }}
            </h{{ section.ng_level }}>
          </td>
        </tr>

        {%- if not loop.last -%}
          {%- if not loop.nextitem.is_section and not loop.nextitem.is_free_text -%}
            {% include "single_document_table/table-fields.jinja.html" %}
          {%- endif -%}
        {%- endif -%}
      {%- endif %}
  {%- endfor %}
  </table>
</body>
